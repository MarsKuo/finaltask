import{r as k,u as V,o as E,a as r,S as d,c as h,b as n,d as i,e as t,w as a,f as g,v as F,n as $,g as T,F as x,h as b,t as v}from"./index-PVytKBtw.js";const P={id:"todoListPage",class:"bg-half"},J={class:"conatiner todoListPage vhContainer"},R={class:"todoList_Content"},W={class:"inputBox"},j={key:0,class:"todoList_list"},q={class:"todoList_tab"},G={class:"todoList_items"},H={class:"todoList_item"},K={class:"todoList_label"},Q=["checked","onClick"],X=["onClick"],Y={class:"todoList_statistics"},Z={class:"todoList_items"},tt={class:"todoList_item"},et={class:"todoList_label"},st=["checked","onClick"],ot=["onClick"],nt={class:"todoList_statistics"},it={class:"todoList_items"},lt={class:"todoList_item"},at={class:"todoList_label"},ut=["checked","onClick"],ct=["onClick"],rt={class:"todoList_statistics"},dt={key:1},p="https://todolist-api.hexschool.io",pt={__name:"TodolistVIew",setup(ht){var z;const u=k(""),C=V(),A=k(""),B=(z=document.cookie.split("; ").find(e=>e.startsWith("hexschoolTodo=")))==null?void 0:z.split("=")[1];E(async()=>{if(B){u.value=B;try{const e=await r.get(`${p}/users/checkout`,{headers:{Authorization:`${u.value}`}});A.value=e.data.uid,m()}catch(e){console.log(e),d.fire({icon:"error",title:"登入逾時，即將為您導回登入頁",text:"Something went wrong!",showConfirmButton:!1,timer:2e3}),setTimeout(()=>{C.push("/login")},2e3)}}else d.fire({icon:"error",title:"登入逾時，即將為您導回登入頁",text:"Something went wrong!",showConfirmButton:!1,timer:2e3}),setTimeout(()=>{C.push("/login")},2e3)});const D=async()=>{try{await r.post(`${p}/users/sign_out`,{},{headers:{Authorization:`${u.value}`}}),document.cookie="hexschoolTodo=; expires=Thu, 01 Jan 1970 00:00:00 UTC;",d.fire({position:"center",icon:"success",title:"登出成功，即將為您導回登入頁",showConfirmButton:!1,timer:1500}),setTimeout(()=>{C.push("/login")},1500)}catch{d.fire({position:"center",icon:"danger",title:"登出失敗",showConfirmButton:!1,timer:1500})}},c=k("1"),y=e=>{c.value=e},l=k([]),_=k(""),I=async()=>{if(!_.value)return;const e={content:_.value};try{const s=await r.post(`${p}/todos`,e,{headers:{Authorization:`${u.value}`}});console.log("11",s),m(),_.value="",d.fire({position:"center",icon:"success",title:"新增成功",showConfirmButton:!1,timer:1e3})}catch(s){console.log(s)}},m=async()=>{try{const e=await r.get(`${p}/todos`,{headers:{Authorization:`${u.value}`}});console.log(e),l.value=e.data.data}catch(e){console.log(e)}},M=h(()=>l.value);h(()=>l.value.length);const N=h(()=>l.value.filter(e=>e.status===!1)),S=h(()=>l.value.filter(e=>e.status===!1).length),O=h(()=>l.value.filter(e=>e.status===!0)),U=h(()=>l.value.filter(e=>e.status===!0).length),L=async e=>{await r.patch(`${p}/todos/${e}/toggle`,{},{headers:{Authorization:u.value}}),m()},w=async e=>{await r.delete(`${p}/todos/${e}`,{headers:{Authorization:u.value}}),m(),d.fire({position:"center",icon:"success",title:"刪除成功",showConfirmButton:!1,timer:1e3})};return(e,s)=>(n(),i("div",P,[t("nav",null,[s[5]||(s[5]=t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1)),t("ul",null,[s[4]||(s[4]=t("li",{class:"todo_sm"},[t("a",{href:"#"},[t("span",null,"王小明的代辦")])],-1)),t("li",null,[t("a",{href:"#",onClick:a(D,["prevent"])},"登出")])])]),t("div",J,[t("div",R,[t("div",W,[g(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":s[0]||(s[0]=o=>_.value=o)},null,512),[[F,_.value]]),t("a",{href:"#",onClick:a(I,["prevent"])},s[6]||(s[6]=[t("i",{class:"fa fa-plus"},null,-1)]))]),l.value.length>0?(n(),i("div",j,[t("ul",q,[t("li",null,[t("a",{href:"#",class:$(c.value==="1"?"active":""),onClick:s[1]||(s[1]=a(o=>y("1"),["prevent"]))},"全部",2)]),t("li",null,[t("a",{href:"#",class:$(c.value==="2"?"active":""),onClick:s[2]||(s[2]=a(o=>y("2"),["prevent"]))},"待完成",2)]),t("li",null,[t("a",{href:"#",class:$(c.value==="3"?"active":""),onClick:s[3]||(s[3]=a(o=>y("3"),["prevent"]))},"已完成",2)])]),g(t("div",G,[t("ul",H,[(n(!0),i(x,null,b(M.value,o=>(n(),i("li",{key:o.id},[t("label",K,[t("input",{class:"todoList_input",type:"checkbox",value:"true",checked:o.status,onClick:f=>L(o.id)},null,8,Q),t("span",null,v(o.content),1)]),t("a",{href:"#",onClick:a(f=>w(o.id),["prevent"])},s[7]||(s[7]=[t("i",{class:"fa fa-times"},null,-1)]),8,X)]))),128))]),t("div",Y,[t("p",null,v(S.value)+" 個待完成項目",1)])],512),[[T,c.value==="1"]]),g(t("div",Z,[t("ul",tt,[(n(!0),i(x,null,b(N.value,o=>(n(),i("li",{key:o.id},[t("label",et,[t("input",{class:"todoList_input",type:"checkbox",value:"true",checked:o.status,onClick:f=>L(o.id)},null,8,st),t("span",null,v(o.content),1)]),t("a",{href:"#",onClick:a(f=>w(o.id),["prevent"])},s[8]||(s[8]=[t("i",{class:"fa fa-times"},null,-1)]),8,ot)]))),128))]),t("div",nt,[t("p",null,v(S.value)+" 個待完成項目",1)])],512),[[T,c.value==="2"]]),g(t("div",it,[t("ul",lt,[(n(!0),i(x,null,b(O.value,o=>(n(),i("li",{key:o.id},[t("label",at,[t("input",{class:"todoList_input",type:"checkbox",value:"true",checked:o.status,onClick:f=>L(o.id)},null,8,ut),t("span",null,v(o.content),1)]),t("a",{href:"#",onClick:a(f=>w(o.id),["prevent"])},s[9]||(s[9]=[t("i",{class:"fa fa-times"},null,-1)]),8,ct)]))),128))]),t("div",rt,[t("p",null,v(U.value)+" 個已完成項目",1)])],512),[[T,c.value==="3"]])])):(n(),i("div",dt," 目前尚無待辦事項 "))])])]))}};export{pt as default};
